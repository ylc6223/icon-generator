# Icon Extractor - 测试计划

## 测试目标
确保 Icon Extractor 应用的功能完整性、性能表现和用户体验质量，为正式发布做好准备。

---

## 1. 功能测试

### 1.1 图像上传功能
**测试步骤**：
1. 点击上传区域选择文件
2. 拖拽图像文件到上传区域
3. 测试支持的格式：PNG, JPG, WEBP, SVG
4. 测试不支持的格式：PDF, GIF（应显示错误提示）
5. 测试大文件上传（>10MB）

**预期结果**：
- 支持的格式能正确上传并显示预览
- 不支持的格式显示友好错误提示
- 文件大小和尺寸信息正确显示

### 1.2 网格检测功能
**测试步骤**：
1. 上传包含图标网格的图像（例如 3x3, 4x4, 5x5）
2. 设置正确的行数和列数
3. 点击"开始检测"按钮
4. 验证检测出的边界框数量和位置

**预期结果**：
- 边界框数量 = 行数 × 列数
- 边界框位置准确覆盖各个图标
- 检测进度正确显示

### 1.3 边界框编辑功能
**测试步骤**：
1. 选择一个边界框
2. 拖拽移动位置
3. 拖拽调整大小（4个角 + 4条边）
4. 删除边界框（Delete 键或按钮）
5. 测试撤销/重做功能（Ctrl+Z, Ctrl+Y）
6. 测试键盘快捷键（Esc 取消选择）

**预期结果**：
- 边界框可以流畅拖拽和调整
- 控制点响应灵敏
- 撤销/重做正确记录历史
- 键盘快捷键正常工作

### 1.4 图标标签功能
**测试步骤**：
1. 点击边界框标签
2. 编辑标签名称
3. 测试验证规则：
   - 空标签
   - 超过50字符
   - 非法字符（/ \ : * ? " < > |）
   - 重复标签
4. 测试保存和取消（Enter, Esc）
5. 验证导出时使用标签作为文件名

**预期结果**：
- 验证规则正确拦截无效输入
- 错误提示清晰准确
- 有效标签正确保存

### 1.5 矢量化功能
**测试步骤**：
1. 选择不同的矢量化预设（balanced, clean, precise）
2. 批量矢量化检测到的图标
3. 检查进度条和百分比显示
4. 验证 SVG 文件生成
5. 对比不同预设的效果差异

**预期结果**：
- 进度正确显示
- VTracer WASM 作为首选算法
- potrace 作为降级方案
- SVG 文件格式正确
- 预设参数影响可见

### 1.6 预览功能
**测试步骤**：
1. 选择已矢量化的图标
2. 在预览面板中查看原图和 SVG 对比
3. 测试缩放功能（1x, 2x, 4x, 8x）
4. 检查文件大小和节点数统计
5. 验证质量警告显示

**预期结果**：
- 原图和 SVG 正确并排显示
- 缩放功能流畅
- 统计数据准确
- 质量问题正确提示

### 1.7 导出功能
**测试步骤**：
1. 选择多个图标导出
2. 选择部分图标导出
3. 不选择任何图标导出（应导出全部）
4. 解压下载的 ZIP 文件
5. 验证文件名（使用标签或 ID）
6. 验证 SVG 文件内容

**预期结果**：
- ZIP 文件正确下载
- 文件数量符合选择
- 文件名正确使用标签
- SVG 文件可在浏览器/设计软件中打开

---

## 2. 性能测试

### 2.1 大图片处理
**测试用例**：
- 2048x2048 像素图像
- 4096x4096 像素图像
- 8192x8192 像素图像

**测试指标**：
- 上传时间
- 检测耗时
- 内存占用
- UI 响应性

**预期结果**：
- UI 不会冻结
- 进度条正确显示
- 内存占用合理（<500MB）

### 2.2 大批量图标处理
**测试用例**：
- 50 个图标（5x10）
- 100 个图标（10x10）
- 200 个图标（10x20）

**测试指标**：
- 矢量化总耗时
- 分块处理是否生效（100 个一批）
- Worker 并发是否生效（4 个并发）
- 内存占用变化

**预期结果**：
- 100 个图标自动分块处理
- 4 个 Worker 并发工作
- 内存不会持续增长
- 总耗时 ≈ 单个图标耗时 × 总数 / 4

### 2.3 预览性能
**测试用例**：
- 快速切换选中不同图标
- 连续点击多个边界框
- 高缩放级别（8x）

**测试指标**：
- SVG 懒加载是否生效
- UI 卡顿情况
- 内存占用

**预期结果**：
- SVG 延迟 100ms 加载
- 快速切换时不会卡顿
- 内存不会泄漏

---

## 3. 兼容性测试

### 3.1 浏览器兼容性
**测试浏览器**：
- Chrome 120+
- Firefox 120+
- Safari 17+
- Edge 120+

**测试功能**：
- 图像上传和预览
- WebWorker 并发处理
- WASM 模块加载
- 文件下载

**预期结果**：
- 所有主流浏览器正常运行
- Safari 支持 OffscreenCanvas
- WASM 在所有浏览器加载

### 3.2 响应式布局
**屏幕尺寸测试**：
- 1920x1080（桌面）
- 1366x768（笔记本）
- 768x1024（平板）

**测试内容**：
- 左右侧边栏在小屏幕隐藏
- 画布区域自适应
- 控件可用性

---

## 4. 边界情况测试

### 4.1 异常输入
- 上传空文件
- 上传损坏的图像文件
- 上传纯色图像（无图标）
- 设置 0 行或 0 列
- 设置超大行列（1000x1000）

**预期结果**：
- 显示友好错误提示
- 应用不会崩溃

### 4.2 网络异常
- 断网状态使用（所有功能都应离线可用）
- 恢复网络后功能正常

### 4.3 并发操作
- 快速重复点击"开始检测"按钮
- 矢量化过程中上传新图像
- 处理中切换视图模式

**预期结果**：
- 防止重复点击
- 正在处理时禁用相关按钮
- 状态正确转换

---

## 5. 安全性测试

### 5.1 文件安全
- 测试上传恶意文件（.exe, .sh）
- 测试文件名注入攻击（文件名包含 `../` 等）

**预期结果**：
- 只允许图像格式
- 文件名正确过滤

### 5.2 数据隐私
- 验证所有处理都在本地完成
- 检查是否有网络请求（除了加载资源）

**预期结果**：
- 无数据上传到服务器
- StatusBar 显示"本地处理"提示

---

## 6. 用户体验测试

### 6.1 操作流程
**完整流程**：
1. 上传图像
2. 设置网格参数
3. 检测图标
4. 调整边界框
5. 编辑标签
6. 选择矢量化预设
7. 矢量化
8. 预览效果
9. 导出 ZIP

**测试标准**：
- 新用户无需文档可完成
- 每步操作都有明确反馈
- 错误可轻松恢复

### 6.2 交互反馈
- 按钮悬停状态
- 加载状态指示
- 进度百分比显示
- 错误提示样式

---

## 7. Bug 记录模板

```
Bug ID: #001
标题: [简短描述]
严重性: Critical / High / Medium / Low
步骤:
1. ...
2. ...
3. ...

预期结果: ...
实际结果: ...

环境:
- 浏览器: Chrome 120.0.0
- 屏幕尺寸: 1920x1080
- 图像大小: 2048x2048

复现频率: 总是 / 有时 / 偶尔
```

---

## 8. 测试完成标准

### 8.1 必须满足
- [ ] 所有功能测试用例通过
- [ ] 性能测试指标达标
- [ ] 主流浏览器兼容
- [ ] 无 Critical 级别 Bug
- [ ] High 级别 Bug < 3

### 8.2 建议满足
- [ ] Medium 级别 Bug < 10
- [ ] 所有边界情况有处理
- [ ] 用户体验评分 > 4/5

---

## 9. 测试时间表

| 阶段 | 任务 | 预计时间 |
|------|------|---------|
| Day 1 | 功能测试（1.1-1.4） | 2 小时 |
| Day 2 | 功能测试（1.5-1.7） | 2 小时 |
| Day 3 | 性能测试 | 2 小时 |
| Day 4 | 兼容性测试 | 2 小时 |
| Day 5 | 边界情况测试 | 1 小时 |
| Day 6 | Bug 修复 | 4 小时 |
| Day 7 | 回归测试 | 2 小时 |

---

## 10. 测试报告模板

```markdown
# Icon Extractor 测试报告

**测试日期**: 2026-01-XX
**测试版本**: v0.2.0
**测试人员**: [姓名]

## 测试概览
- 功能测试: X/Y 通过
- 性能测试: X/Y 通过
- 兼容性测试: X/Y 通过
- Bug 总数: X 个

## 发现的 Bug
| Bug ID | 严重性 | 状态 | 描述 |
|--------|--------|------|------|
| #001 | High | 已修复 | ... |
| #002 | Medium | 待修复 | ... |

## 性能指标
- 100 个图标矢量化耗时: X 秒
- 4096x4096 图像内存占用: X MB
- Worker 并发效率: X%

## 建议
- [改进建议 1]
- [改进建议 2]

## 结论
[通过/不通过/有条件通过]
```
